# План 001: Инициализация проекта и реализация MVP

## Цель (Objective)
Развернуть базовую структуру проекта Support Admin Bot, настроить окружение (Docker, DB) и реализовать функционал Фазы 1 (MVP) согласно продуктовой документации.

## Дата
2026-01-22

## Статус
Утвержден

## Шаги (Proposed Steps)

### 1. Подготовка окружения
- [ ] 1.1. Создать базовую структуру папок (`bot/`, `handlers/`, `services/`, `database/` и т.д.) согласно `docs/tech.md`.
- [ ] 1.2. Настроить `pyproject.toml` с зависимостями (aiogram, sqlalchemy, alembic, asyncpg, pydantic-settings, apscheduler).
- [ ] 1.3. Создать `.gitignore` и `.env.example`.
- [ ] 1.4. Настроить Docker-окружение (`Dockerfile`, `docker-compose.yml`) с PostgreSQL.

### 2. База данных
- [ ] 2.1. Настроить подключение к БД (`database/session.py`, `config.py`).
- [ ] 2.2. Реализовать модели данных для MVP (`Employee`, `Duty`) в `database/models.py`.
- [ ] 2.3. Настроить Alembic и создать начальную миграцию.

### 3. Базовый бот
- [ ] 3.1. Реализовать точку входа (`bot/__main__.py`) и запуск поллинга.
- [ ] 3.2. Добавить обработчик `/start` и `/help` (`handlers/common.py`).
- [ ] 3.3. Проверить запуск бота в Docker-контейнере.

### 4. Реализация функционала MVP
- [ ] 4.1. Реализовать репозиторий `EmployeeRepository` (CRUD сотрудников).
- [ ] 4.2. Реализовать команду `/start` с автоматической/ручной регистрацией (проверка `is_active`).
- [ ] 4.3. Реализовать админские команды управления сотрудниками (`/employees`, `/addemployee`).
- [ ] 4.4. Реализовать репозиторий `DutyRepository`.
- [ ] 4.5. Реализовать команды управления дежурствами (`/setduty`, `/removeduty`, `/duty`).
- [ ] 4.6. Реализовать просмотр своих дежурств (`/myduties`).

### 5. Планировщик и напоминания
- [ ] 5.1. Подключить `APScheduler`.
- [ ] 5.2. Реализовать джобу утреннего напоминания (проверка дежурного на сегодня).
- [ ] 5.3. Настроить запуск планировщика при старте бота.

## Риски
- Проблемы с подключением бота к БД внутри Docker (сетевые настройки).
- Конфликты версий библиотек (фиксировать версии в `pyproject.toml`).

## Стратегия отката
- В случае проблем с миграциями: `alembic downgrade base`.
- В случае критических ошибок кода: `git revert`.
